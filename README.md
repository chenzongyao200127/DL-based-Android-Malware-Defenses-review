# Deep Learning for Android Malware Defenses

> 11/2/2022

This is an updating survey fo deep learning-based Android malware defenses, an constantly updated version for the manuscript, ["**Deep Learning for Android Malware Defenses: a Systematic Literature Review**"](https://dl.acm.org/doi/10.1145/3544968#) by Yue Liu, Li Li, Chakkrit Tantithamthavorn and Yepang Liu. This paper has been accepted by **ACM Computing Surveys**.

> To the best of our knowledge, no systematic literature review focusing on deep learning approaches for Android Malware defenses exists. In this paper, we conducted a systematic literature review to search and analyze how deep learning approaches have been applied in the context of malware defenses in the Android environment. As a result, a total of 132 studies covering the period 2014-2021 were identified. Our investigation reveals that, while the majority of these sources mainly consider DL-based on Android malware detection, 53 primary studies (40.1 percent) design defense approaches based on other scenarios. This review also discusses research trends, research focuses, challenges, and future research directions in DL-based Android malware defenses.

Please kindly cite this paper if it helps you research: 

```
@article{liu2022deep,
	doi = {10.1145/3544968},
	url = {https://doi.org/10.1145/3544968},
	year = 2022,
	month = {jun},
	publisher = {Association for Computing Machinery ({ACM})},
	author = {Yue Liu and Chakkrit Tantithamthavorn and Li Li and Yepang Liu},
	title = {Deep Learning for Android Malware Defenses: a Systematic Literature Review},
	journal = {{ACM} Computing Surveys}
}
```

If you have any question, please contact: yuehhhhliu@gmail.com


**You are welcome to update our review list!!**
* fork this repository, add it and merge back;
* or email us.



## Content

- [Systematic review process](#1)
- [Paper structure](#2)
- [Malware data collection](#3)
- [Public malware defense tools](#4)
- [Supplementary materials](#5)
- [Recent Publications (Updating) ](#6)

<h2 id="1"> Systematic review process and paper lists </h2>

We collected primary studies related DL-based Android malware defenses from a variety of sources (IEEE, ACM Digital Library, Springer, Science Direct, Wiley Online Library, Google Scholar and Web of Knowledge). Only those studies related to deep learning-based Android malware defenses should be considered for further review;in addition, we proposed a quality appraisal criterion to obtain high-quality studies. 

The complete list of exclusion criteria and quality appraisal criterion is available at this [page](files/review_methodology.md).

After that, we obtained 132 relevant parimary studies.


<h2 id="2"> Paper structure </h2>
We uploaded our completed paper lists Google Drive with detailed reviewed informatio. 

([Rewiew paper lists](https://docs.google.com/spreadsheets/d/1MSPEBEJkvzw2HTS0U2sArRO0gSggvqYf6QZbVhyGSVo/edit?usp=sharing/))

Our paper is structured as below: 

- Malware Defenses Objectives
  - binary malware classification
  - malware family attribution
  - repackaged/fake app detection
  - adversarial learning attacks and protections
  - malware evolution detection and defense
  - malicious behavior analysis
- APK Characterization
  - Program analysis approaches (static analysis, dynamic analysis, hybrid analysis)
  - Feature categories (permission, API calls, filtered intents, app component, url, string, hardware component, app metadata, system call, dynamic activities, program graph, opcode, bytecode, java code)
  - Feature encoding approaches (categorical, text-based, graph-based, image-based, hybrid)
- Deep Learning Techniques
  - Learning paradigms (supervised, supervised & unsupervised, unsupervised, reinforcement learning)
  - Deep learning models (Multilayer Perceptrons, Convolutional Neural Networks, Recurrent Neural Networks, Deep Belief Networks, Autoencoders, Generative Adversarial Networks, Graph Neural Networks, Attention-based neural networks, Deep Reinforcement Learning, Transformers, Hybrid models)
  - Model explanation
- Deployment
  - Off-device, Distributed, On-device
- Performance evaluation
   - Dataset
   - Evaluation approaches
   - Evaluation metrics
   - Availability 

If you are interested in the summary of each subtopic for these 132 primary studies, you can read our [survey](https://arxiv.org/abs/2103.05292) to catch more information;

If you want to check detailed information for each primary study, you can read our review table.

<h2 id="3"> Malware data collection </h2>

Data sources|Is update|Paper|Details
--|:--:|:--:|:--
[Drebin](https://www.sec.cs.tu-bs.de/~danarp/drebin/)|-|[NDSS-2014](https://www.researchgate.net/profile/Hugo_Gascon/publication/264785935_DREBIN_Effective_and_Explainable_Detection_of_Android_Malware_in_Your_Pocket/links/53efd0020cf26b9b7dcdf395.pdf)| 123453 benign samples and 5560 malware(176 malware families); 2010-2012 samples
[Genome](http://www.malgenomeproject.org)|-| [S&P-2012](https://ieeexplore.ieee.org/abstract/document/6234407/)  | 863 benign and 1260 malware; 2010-2011 samples
[Contagio](http://contagiominidump.blogspot.com/)|-|-| it consists of 11,960 mobile malware samples and 16,800 benign samples utill 2018
[AMD](http://amd.arguslab.org)|-| [DIMVA-2017](https://link.springer.com/chapter/10.1007/978-3-319-60876-1_12) | 24553 malware (2010-2016) 
[AndroZoo](https://androzoo.uni.lu) |Yes| [MSR-2016](https://dl.acm.org/doi/10.1145/2901739.2903508) | AndroZoo is a growing collection of Android Applications collected from several sources, including the official Google Play app market. It currently contains 17,951,878 different APKs.
[VirusTotal](https://www.virustotal.com/gui/contact-us/premium-services) |Yes|-| VirusTotal aggregates many antivirus products and online scan engines. It also provide datasets for researchers
[VirusShare](https://virusshare.com/)|Yes| -| VirusShare is a repository of malware samples to provide security researchers. System currently contains 44,390,572 malware samples.
[CICMalDroid](https://www.unb.ca/cic/datasets/maldroid-2020.html)|-|-|It has more than 17,341 Android samples utill 2018.
[RmvDroid](https://zenodo.org/record/2593596#.YGxM4-gzZPY)|-|[MSR-2019](https://ieeexplore.ieee.org/abstract/document/8816783)|  9,133 malware samples, which belong to 56 malware families
[Google Play](https://www.android.com/play-protect/)|Yes|-|Google play is the official Android market. [PlayDrone: Google crawler](https://github.com/nviennot/playdrone)
Thirt-party markets|Yes|-|[HUAWEI](https://appgallery.huawei.com/#/Featured), [APKpure](https://apkpure.com/), [MI store](https://app.mi.com/), [Tencent](https://android.myapp.com/), [360](http://zhushou.360.cn/), [Wandoujia](https://www.wandoujia.com/), [Aptoide](https://en.aptoide.com/),[Anzhi](http://www.anzhi.com/), [APKmirror](https://www.apkmirror.com/), [Amazon Appstore](https://www.amazon.com/mobile-apps), [9APPS](https://www.9apps.com/)

### Anti-virus tools

- VirusTotal: Analyze suspicious files and URLs to detect types of malware, automatically share them with the security community. [[Project link]](https://www.virustotal.com/) [[Request for research API]](https://www.virustotal.com/gui/contact-us/premium-services)

<h2 id="4"> Public tools </h2>

### Deep learning-based Android malware defense approaches

**基于深度学习的Android恶意软件防御方法**

- Deep Android Malware Detection

  - Bianry Malware Classification; CNN; Opcode Sequence

  - in CODASPY '17  [[pdf]](https://dora.dmu.ac.uk/bitstream/handle/2086/16947/Deep-Android-Malware-Detection.pdf?sequence=1&isAllowed=y) [[Code]](https://github.com/niallmcl/Deep-Android-Malware-Detection)

- A Multimodal Deep Learning Method for Android Malware Detection Using Various Features

  - Bianry Malware classification; CNN; Multiple features (String,method opcode, method API, shared library  function opcode, permission, App component, environmental feature)  
  - in TIFS 2018, [[pdf]](https://ieeexplore.ieee.org/document/8443370) [[Code]](https://github.com/hejinsome/A-Multimodal-Deep-Learning-Method-for-Android-Malware-Detection)

- Detecting Android malware using Long Short-term Memory (LSTM)

  - Bianry Malware Classification; LSTM; Permissions, dynamic behaviour
  - in Journal of Intelligent & Fuzzy Systems, 2018, [[pdf]](https://content.iospress.com/articles/journal-of-intelligent-and-fuzzy-systems/ifs169424)[[Code]](https://github.com/vinayakumarr/Android-Malware-Detection)

- {TESSERACT}: Eliminating experimental bias in malware classification across space and time

  - Malware Evolution Detection and Defense, MLP, Drebin's features
  - in USENIX Security Symposium , 2019,  [[pdf]](https://www.usenix.org/conference/usenixsecurity19/presentation/pendlebury)[[Code]](https://s2lab.kcl.ac.uk/projects/tesseract/)

- DeepIntent: Deep Icon-Behavior Learning for Detecting Intention-Behavior Discrepancy in Mobile Apps

  - Malicious Behavior Analysis; CNN,RNN,AE; App metadata
  - in CCS'19, [[pdf]](https://dl.acm.org/doi/abs/10.1145/3319535.3363193) [[Code]](https://github.com/deepintent-ccs/DeepIntent)

- An Android mutation malware detection based on deep learning using visualization of importance from codes

  > **Highlights**
  >
  > - This paper presented a method that can detect Android malwares more conveniently than using general static analysis.
  >
  > - Using convolutional neural network to analyze whether an apk file is a malware or not.
  > - We convert an apk file to java code which is used to generate images by using two algorithms.

  - Bianry Malware Classification; CNN; Java code
  - in Microelectronics Reliability, 2019,  [[pdf]](https://www.sciencedirect.com/science/article/pii/S0026271418308485) [[Code]](https://github.com/chu840121/yys)

- Familial Clustering for Weakly-Labeled Android Malware Using Hybrid Representation Learning

  - Malware family attribution; MLP; Java Code, App components, action, Requested Permission, Hardware,instrumentation classes, requested API, package name, version, referenced libraries.
  - in TIFS 2019,  [[pdf]](https://ieeexplore.ieee.org/abstract/document/8871171/) [[Code]](https://github.com/yanxinzhangpeter/ANDRE)

- **Android Malware Detection Based on System Calls Analysis and CNN Classification**

  - Binary malware classification; CNN; System Call
  - in IEEE Wireless Communications and Networking Conference Workshop (WCNCW), 2019, [[pdf]](https://ieeexplore.ieee.org/document/8902627) [[Code]](https://github.com/stodi1/malwaresdetection)

----------

- Adversarial Deep Ensemble: Evasion Attacks and Defenses for Malware Detection

  - Adversarial Learning Attacks and Protections; MLP; 
  - in TIFS 2020, [[pdf]](https://ieeexplore.ieee.org/abstract/document/9121297/)[[Code]](https://github.com/deqangss/adv-dnn-ens-malware)

- Evaluating explanation methods for deep learning in security

  - Binary malware classification; MLP, CNN
  - in EuroS&P'20; [[pdf]](https://ieeexplore.ieee.org/abstract/document/9230374/) [[code]](https://github.com/alewarne/explain-mlsec)

- Enhancing State-of-the-art Classifiers with API Semantics to Detect Evolved Android Malware

  - Malware Evolution Detection and Defense, Binary Malware Detection; MLP
  - in CCS'20, [[pdf]](https://dl.acm.org/doi/abs/10.1145/3319535.3363193) [[code]](https://github.com/seclab-fudan/APIGraph)

- A Multi-modal Neural Embeddings Approach for Detecting Mobile Counterfeit Apps: A Case Study on Google Play Store

  - Repackaged/Fake App Detection; CNN
  - in TMC'20, [[pdf]](http://arxiv.org/abs/2006.02231) [[code]](https://github.com/NaveenHK/Counterfeit-detection)

- DENAS: Automated Rule Generation by Knowledge Extraction from Neural Networks

  - Binary Malware Detection
  - in FSE'20; [[pdf]](https://doi.org/10.1145/3368089.3409733) [[code]](https://github.com/SeekingDream/denas_fse2020)

- Experiences of Landing Machine Learning onto Market-Scale Mobile Malware Detection

  - Binary Malware Detection
  - in EuroSys'20; [[pdf]](https://doi.org/10.1145/3342195.3387530) [[code]](https://apichecker.github.io/)

- Hybrid Analysis of Android Apps for Security Vetting using Deep Learning 

  > The phenomenal growth in use of android devices in the recent years has also been accompanied by the rise of android malware. This reality warrants development of tools and techniques to analyze android apps in large scale for security vetting. Most of the state-of-the-art vetting tools are either based on static analysis or on dynamic analysis. Static analysis has limited success if the malware app utilizes sophisticated evading tricks. Dynamic analysis on the other hand may not find all the code execution paths, which let some malware apps remain undetected. Moreover, the existing static and dynamic analysis vetting techniques require extensive human interaction. To address the above issues, we design a deep learning based hybrid analysis technique, which combines the complementary strengths of each analysis paradigm to attain better accuracy. Moreover, automated feature engineering capability of the deep learning framework addresses the human interaction issue. In particular, using lightweight static and dynamic analysis procedure, we obtain multiple artifacts, and with these artifacts we train the deep learner to create independent models, and then combine them to build a hybrid classifier to obtain the final vetting decision (malicious apps vs. benign apps). The experiments show that our best deep learning model with hybrid analysis achieves an area under the precision-recall curve (AUC) of 0.9998. In this paper, we also present a comparative study of performance measures of the various variants of the deep learning framework. Additional experiments indicate that our vetting system is fairly robust against imbalanced data and is scalable.

  - Binary Malware Classification;  LSTM(Bi-LSTM and Attn-BiLSTM),
  - in IEEE Conference on Communications and Network Security (CNS), 2020 [[pdf]](https://ieeexplore.ieee.org/document/9162341)[[Code]](https://github.com/sankardasroy/deep-learning-for-vetting)

- Understanding Privacy Awareness in Android App Descriptions Using Deep Learning

  > Permissions are a key factor in Android to protect users' privacy. As it is often not obvious why applications require certain permissions, developer-provided descriptions in Google Play and third-party markets should explain to users how sensitive data is processed. Reliably recognizing whether app descriptions cover permission usage is challenging due to the lack of enforced quality standards and a variety of ways developers can express privacy-related facts. 
  >
  > We introduce a machine learning-based approach to identify critical discrepancies between developer-described app behavior and permission usage. By combining state-of-the-art techniques in natural language processing (NLP) and deep learning, we design a convolutional neural network (CNN) for text classification that captures the relevance of words and phrases in app descriptions in relation to the usage of dangerous permissions. Our system predicts the likelihood that an app requires certain permissions and can warn about descriptions in which the requested access to sensitive user data and system features is textually not represented. We evaluate our solution on 77,000 real-world app descriptions and find that we can identify individual groups of dangerous permissions with a precision between 71% and 93%. To highlight the impact of individual words and phrases, we employ a model explanation algorithm and demonstrate that our technique can successfully bridge the semantic gap between described app functionality and its access to security- and privacy-sensitive resources.

  - Malicious Behavior Analysis, CNN
  - in ACM Conference on Data and Application Security and Privacy, 2020, [[pdf]](https://dl.acm.org/doi/abs/10.1145/3374664.3375730)[[Code]](https://github.com/sg10/android-privacy)

- Combining multi-features with a neural joint model for Android malware detection

  - Binary Malware Detection, Malware Family Identification; RNN, CNN, 
  - in Journal of Intelligent & Fuzzy Systems, 2020, [[pdf]](https://content.iospress.com/articles/journal-of-intelligent-and-fuzzy-systems/ifs190888) [[Code]](https://github.com/peixj/BIHAD)

- Experimental comparison of features and classifiers for Android malware detection

  - Binary Malware classification; MLP,CNN,RNN,
  - in International Conference on Mobile Software Engineering and Systems, 2020, [[pdf]](https://ink.library.smu.edu.sg/sis_research/5115/)[[Code]](https://github.com/sharlwinkhin/msoft20)

- A Framework for Enhancing Deep Neural Networks Against Adversarial Malware

  - Adversarial Learning Attacks and Protections; AE, MLP
  - in IEEE Transactions on Network Science and Engineering, 2021 [[pdf]](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=9321695)[[Code]](https://github.com/deqangss/aics2019_challenge_adv_mal_defense)

- Towards an interpretable deep learning model for mobile malware detection and family identification

  > Mobile devices are pervading everyday activities of our life. Each day we store a plethora of sensitive and private information in smart devices such as smartphones or tablets, which are typically equipped with an always-on internet connection. These information are of interest for malicious writers that are developing more and more aggressive harmful code for stealing sensitive and private information from mobile devices. 
  >
  > Considering the weaknesses exhibited from current antimalware signature-based detection, in this paper we propose a method relying on application representation in terms on images used to input an explainable deep learning model designed by authors for Android malware detection and family identification. Moreover, we show how the explainability can be considered from the analyst to assess different models. Experimental results demonstrated the effectiveness of the proposed method, obtaining an average accuracy ranging from 0.96 to 0.97; we evaluated 8446 Android samples belonging to six different malware families and one more family for trusted samples, by providing also interpretability about the predictions performed by the model.

  - Malware Family Identification; CNN
  - in Computers & Security 2021 [[pdf]](https://www.sciencedirect.com/science/article/pii/S0167404821000225)[[Code]](https://github.com/Djack1010/towards_interpretable_DL_models)

- Explanation-Guided Backdoor Poisoning Attacks Against Malware Classifiers

  > Training pipelines for machine learning (ML) based malware classification often rely on crowdsourced threat feeds, exposing a natural attack injection point. In this paper, we study the susceptibility of feature-based ML malware classifiers to backdoor poisoning attacks, specifically focusing on challenging "clean label" attacks where attackers do not control the sample labeling process. We propose the use of techniques from explainable machine learning to guide the selection of relevant features and values to create effective backdoor triggers in a model-agnostic fashion. Using multiple reference datasets for malware classification, including Windows PE files, PDFs, and Android applications, we demonstrate effective attacks against a diverse set of machine learning models and evaluate the effect of various constraints imposed on the attacker. To demonstrate the feasibility of our backdoor attacks in practice, we create a watermarking utility for Windows PE files that preserves the binary's functionality, and we leverage similar behavior-preserving alteration methodologies for Android and PDF files. Finally, we experiment with potential defensive strategies and show the difficulties of completely defending against these attacks, especially when the attacks blend in with the legitimate sample distribution.

  - Adversarial Learning Attacks and Protections; MLP
  - in USENIX Security Symposium 2021 [[pdf]](https://www.usenix.org/conference/usenixsecurity21/presentation/severi)[[Code]](https://github.com/ClonedOne/MalwareBackdoors)

- CADE: Detecting and Explaining Concept Drift Samples for Security Applications

  > **Concept drift** poses a critical challenge to deploy machine learning models to solve practical security problems. Due to the dynamic behavior changes of attackers (and/or the benign counterparts), the testing data distribution is often shifting from the original training data over time, causing major failures to the deployed model.
  >
  > To combat concept drift, we present a novel system CADE aiming to 1) detect drifting samples that deviate from existing classes, and 2) provide explanations to reason the detected drift. Unlike traditional approaches (that require a large number of new labels to determine concept drift statistically), we aim to identify individual drifting samples as they arrive. Recognizing the challenges introduced by the high-dimensional outlier space, we propose to map the data samples into a low-dimensional space and automatically learn a distance function to measure the dissimilarity between samples. Using contrastive learning, we can take full advantage of existing labels in the training dataset to learn how to compare and contrast pairs of samples. To reason the meaning of the detected drift, we develop a distance-based explanation method. We show that explaining “distance” is much more effective than traditional methods that focus on explaining a “decision boundary” in this problem context. We evaluate CADE with two case studies: Android malware classification and network intrusion detection. We further work with a security company to test CADE on its malware database. Our results show that CADE can effectively detect drifting samples and provide semantically meaningful explanations.

  - Malware Evolution Detection and Defense; AE
  - in USENIX Security Symposium 2021 [[pdf]](https://www.usenix.org/system/files/sec21-yang-limin.pdf)[[Code]](https://github.com/whyisyoung/CADE)

- DexRay: A Simple, yet Effective Deep Learning Approach to Android Malware Detection Based on Image Representation of Bytecode

  > Computer vision has witnessed several advances in recent years, with unprecedented performance provided by deep representation learning research. Image formats thus appear attractive to other fields such as malware detection, where deep learning on images alleviates the need for comprehensively hand-crafted features generalising to different malware variants. We postulate that this research direction could become the next frontier in Android malware detection, and therefore requires a clear roadmap to ensure that new approaches indeed bring novel contributions. We contribute with a first building block by developing and assessing a baseline pipeline for image-based malware detection with straightforward steps.
  >
  > We propose DEXRAY, which converts the bytecode of the app DEX files into grey-scale “vector” images and feeds them to a 1-dimensional Convolutional Neural Network model. We view DEXRAY as foundational due to the exceedingly basic nature of the design choices, allowing to infer what could be a minimal performance that can be obtained with image-based learning in malware detection.
  >
  > The performance of DEXRAY evaluated on over 158k apps demonstrates that, while simple, our approach is effective with a high detection rate (F1-score =0.96). Finally, we investigate the impact of time decay and image-resizing on the performance of DEXRAY and assess its resilience to obfuscation.
  >
  > This **work-in-progress paper** contributes to the domain of Deep Learning based Malware detection by providing a sound, simple, yet effective approach (with available artefacts) that can be the basis to scope the many profound questions that will need to be investigated to fully develop this domain.

  - Binary Malware Detection; CNN
  - in Deployable Machine Learning for Security Defense 2021 [[pdf]](http://link.springer.com/chapter/10.1007/978-3-030-87839-9_4)[[Code]](https://github.com/Trustworthy-Software/DexRay)

- Can We Leverage Predictive Uncertainty to Detect Dataset Shift and Adversarial Examples in Android Malware Detection?

  > The deep learning approach to detecting malicious software (malware) is promising but has yet to tackle the problem of dataset shift, namely that the joint distribution of examples and their labels associated with the test set is different from that of the training set. This problem causes the degradation of deep learning models without users' notice. In order to alleviate the problem, one approach is to let a classifier not only predict the label on a given example but also present its uncertainty (or confidence) on the predicted label, whereby a defender can decide whether to use the predicted label or not. While intuitive and clearly important, the capabilities and limitations of this approach have not been well understood. 
  >
  > In this paper, we conduct an empirical study to evaluate the quality of predictive uncertainties of malware detectors. Specifically, we re-design and build 24 Android malware detectors (by transforming four off-the-shelf detectors with six calibration methods) and quantify their uncertainties with nine metrics, including three metrics dealing with data imbalance. Our main findings are: (i) predictive uncertainty indeed helps achieve reliable malware detection in the presence of dataset shift, but cannot cope with adversarial evasion attacks; (ii) approximate Bayesian methods are promising to calibrate and generalize malware detectors to deal with dataset shift, but cannot cope with adversarial evasion attacks; (iii) adversarial evasion attacks can render calibration methods useless, and it is an open problem to quantify the uncertainty associated with the predicted labels of adversarial examples (i.e., it is not effective to use predictive uncertainty to detect adversarial examples).

  - Malware Evolution Detection and Defense, Adversarial Learning Attacks and Protections; MLP, CNN, RNN
  - in ACSAC'21 [[pdf]](https://arxiv.org/abs/2109.09654)[[Code]](https://github.com/deqangss/malware-uncertainty)

- Why an Android App is Classified as Malware? Towards Malware Classification Interpretation

  > Machine learning (ML) based approach is considered as one of the most promising techniques for Android malware detection and has achieved high accuracy by leveraging commonly-used features. In practice, most of the ML classifications only provide a binary label to mobile users and app security analysts. However, stakeholders are more interested in the reason why apps are classified as malicious in both academia and industry. This belongs to the research area of interpretable ML but in a specific research domain (i.e., mobile malware detection). Although several interpretable ML methods have been exhibited to explain the final classification results in many cutting-edge Artificial Intelligent (AI) based research fields, till now, there is no study interpreting why an app is classified as malware or unveiling the domain-specific challenges.
  > In this paper, to fill this gap, we propose a novel and interpretable ML-based approach (named XMal) to classify malware with high accuracy and explain the classification result meanwhile. (1) The first classification phase of XMal hinges multi-layer perceptron (MLP) and attention mechanism, and also pinpoints the key features most related to the classification result. (2) The second interpreting phase aims at automatically producing neural language descriptions to interpret the core malicious behaviors within apps. We evaluate the behavior description results by comparing with the existing interpretable ML-based methods (i.e., Drebin and LIME) to demonstrate the effectiveness of XMal. We find that XMal is able to reveal the malicious behaviors more accurately. Additionally, our experiments show that XMal can also interpret the reason why some samples are misclassified by ML classifiers. Our study peeks into the interpretable ML through the research of Android malware detection and analysis.

  - Malware detection; attention-based nueral networks
  - in TOSEM 2021, [[pdf]](https://arxiv.org/abs/2004.11516)[[Code]](https://github.com/wubozhi/Xmal)

- Heterogeneous Temporal Graph Transformer: An Intelligent System for Evolving Android Malware Detection

  > The explosive growth and increasing sophistication of Android malware call for new defensive techniques to protect mobile users against novel threats. To address this challenge, in this paper, we propose and develop an intelligent system named Dr.Droid to jointly model malware propagation and evolution for their detection at the first attempt. In Dr.Droid, we first exploit higher-level semantic and social relations within the ecosystem (e.g., app-market, app-developer, market-developer relations etc.) to characterize app propagation patterns; and then we present a structured heterogeneous graph to model the complex relations among different types of entities. To capture malware evolution, we further consider the temporal dependence and introduce a heterogeneous temporal graph to jointly model malware propagation and evolution by considering heterogeneous spatial dependencies with temporal dimensions. 
  >
  > Afterwards, we propose a novel heterogeneous temporal graph transformer framework (denoted as HTGT) to integrate both spatial and temporal dependencies while preserving the heterogeneity to learn node representations for malware detection. Specifically, in our proposed HTGT, to preserve the heterogeneity, we devise a heterogeneous spatial transformer to derive heterogeneous attentions over each node and edge to learn dedicated representations for different types of entities and relations; to model temporal dependencies, we design a temporal transformer into the HTGT to attentively aggregate its historical sequences of a given node (e.g., app); the two transformers work in an iterative manner for representation learning. Promising experimental results based on the large-scale sample collections from anti-malware industry demonstrate the performance of Dr.Droid, by comparison with state-of-the-art baselines and popular mobile security products.

  - Malware Evolution Detection and Defense, Binary Malware Detection; transformers, GNN
  - in SIGKDD'21[[pdf]](https://doi.org/10.1145/3447548.3467168)[[Code]](https://github.com/kdd2021drdroid/KDD2021_DrDroid)

- Robust Android Malware Detection against Adversarial Example Attacks

  > Adversarial examples pose severe threats to Android malware detection because they can render the machine learning based detection systems useless. How to effectively detect Android malware under various adversarial example attacks becomes an essential but very challenging issue. Existing adversarial example defense mechanisms usually rely heavily on the instances or the knowledge of adversarial examples, and thus their usability and effectiveness are significantly limited because they often cannot resist the unseen-type adversarial examples. 
  >
  > In this paper, we propose a novel robust Android malware detection approach that can resist adversarial examples without requiring their instances or knowledge by jointly investigating malware detection and adversarial example defenses. More precisely, our approach employs a new VAE (variational autoencoder) and an MLP (multi-layer perceptron) to detect malware, and combines their detection outcomes to make the final decision. In particular, we share a feature extraction network between the VAE and the MLP to reduce model complexity and design a new loss function to disentangle the features of different classes, hence improving detection performance. Extensive experiments confirm our model’s advantage in accuracy and robustness. Our method outperforms 11 state-of-the-art robust Android malware detection models when resisting 7 kinds of adversarial example attacks.

  - Adversarial Learning Attacks and Protections; Hybrid
  - IN WWW'21 [[pdf]](https://doi.org/10.1145/3442381.3450044)[[Code]](https://github.com/YangXiuxuan/Robust-Android-Malware-Detection-Against-Adversarial-Example-Attacks)

- PetaDroid: Adaptive Android Malware Detection Using Deep Learning

  > Android malware detection is a significant problem that affects billions of users using millions of Android applications (apps) in existing markets. Thiss paper proposes PetaDroid, a framework for accurate Android malware detection and family clustering on top of **static analyses**. PetaDroid automatically adapts to Android malware and benign changes over time with resilience to common binary obfuscation techniques. The framework employs novel techniques elaborated on top of natural language processing (NLP) and machine learning techniques to achieve accurate, adaptive, and resilient Android malware detection and family clustering. 
  >
  > We extensively evaluated PetaDroid on multiple reference datasets. PetaDroid achieved a high detection rate (98–99% f1-score) under different evaluation settings with high homogeneity in the produced clusters (96%). We conducted a thorough quantitative comparison with state-of-the-art solutions MaMaDroid, DroidAPIMiner, MalDozer, in which PetaDroid outperforms them under all the evaluation settings.

  - Binary Malware Detection; Hybrid
  - In Detection of Intrusions and Malware, and Vulnerability Assessment 2021 [[pdf]](http://link.springer.com/chapter/10.1007/978-3-030-80825-9_16)[[Code]](https://github.com/mouatez/petadroid)

- Structural Attack against Graph Based Android Malware Detection

  > Malware detection techniques achieve great success with deeper insight into the semantics of malware. Among existing detection techniques, function call graph (FCG) based methods achieve promising performance due to their prominent representations of malware's functionalities. Meanwhile, recent adversarial attacks not only perturb feature vectors to deceive classifiers (i.e., feature-space attacks) but also investigate how to generate real evasive malware (i.e., problem-space attacks). However, existing problem-space attacks are limited due to their inconsistent transformations between feature space and problem space.
  >
  > In this paper, we propose the first structural attack against graph-based Android malware detection techniques, which addresses the inverse-transformation problem [1] between feature-space attacks and problem-space attacks. We design a Heuristic optimization model integrated with Reinforcement learning framework to optimize our structural ATtack (HRAT). HRAT includes four types of graph modifications (i.e., inserting and deleting nodes, adding edges and rewiring) that correspond to four manipulations on apps (i.e., inserting and deleting methods, adding call relation, rewiring). Through extensive experiments on over 30k Android apps, HRAT demonstrates outstanding attack performance on both feature space (over 90% attack success rate) and problem space (up to 100% attack success rate in most cases). Besides, the experiment results show that combing multiple attack behaviors strategically makes the attack more effective and efficient.

  - Adversarial Learning Attacks and Protections; DRL
  - in CCS'21 [[pdf]](https://dl.acm.org/doi/pdf/10.1145/3460120.3485387)[[Code]](https://sites.google.com/view/hrat)



### Machine learning-based tools

- **[Adversarial Deep Learning for Robust Detection of Binary Encoded Malware](https://arxiv.org/pdf/1801.02950.pdf)**, in IEEE Security and Privacy Workshops (SPW), 2018, Adversarial deep learning, [[code]](https://github.com/ALFA-group/robust-adv-malware-detection)

- **[DroidCC](https://github.com/maoqyhz/DroidCC)**: Android malware detection using deep learning, contains android malware samples, papers, tools etc;

- **[MADLIRA](https://github.com/dkhuuthe/MADLIRA)**: Malware detection using learning and information retrieval for Android

- **[android-malware-detection](https://github.com/anoopmsivadas/android-malware-detection)**: Android Malware Detection Using Machine Learning Classifiers ( Using Permissions requested by Apps)

- [MLDroid/drebin](https://github.com/MLDroid/drebin): Drebin - NDSS 2014 Re-implementation

- [MaMadroid](https://bitbucket.org/gianluca_students/mamadroid_code/src/master/): Implementation of [MaMaDroid: Detecting Android Malware by Building Markov Chains of Behavioral Models](https://arxiv.org/abs/1612.04433) in NDSS 2017

- **[Lessons Learnt on Reproducibility in Machine Learning Based Android Malware Detection](https://link.springer.com/article/10.1007/s10664-021-09955-7)**, in Empirical Software Engineering (EMSE).2021, Reproduction of **Drebin, MaMadroid, Malscan, Droidcat, Revealdroid** [[code]](https://github.com/Trustworthy-Software/Reproduction-of-Android-Malware-detection-approaches)

  > A well-known curse of computer security research is that it often produces systems that, while technically sound, fail operationally. To overcome this curse, the community generally seeks to assess proposed systems under a variety of settings in order to make explicit every potential bias. 
  >
  > In this respect, recently, research achievements on machine learning based malware detection are being considered for thorough evaluation by the community. Such an effort of comprehensive evaluation supposes first and foremost the possibility to perform an independent reproduction study in order to sharpen evaluations presented by approaches’ authors. The question Can published approaches actually be reproduced? thus becomes paramount despite the little interest such mundane and practical aspects seem to attract in the malware detection field. In this paper, we attempt a complete reproduction of five Android Malware Detectors from the literature and discuss to what extent they are “reproducible”. Notably, we provide insights on the implications around the guesswork that may be required to finalise a working implementation. Finally, we discuss how barriers to reproduction could be lifted, and how the malware detection field would benefit from stronger reproducibility standards—like many various fields already have.

- **[Lightweight, Obfuscation-Resilient Detection and Family Identification of Android Malware](https://dl.acm.org/doi/pdf/10.1145/3162625)**, in TOSEM 2018, [[code]](https://seal.ics.uci.edu/projects/revealdroid/)



### Program analysis tools

- **Apktool**: A tool for reverse engineering Android apk files [[link]](https://github.com/iBotPeaches/Apktool)
- **Androguard**: Reverse engineering, Malware and goodware static analysis of Android applications ... and more [[link]](https://github.com/androguard/androguard)
- **FlowDroid**: FlowDroid statically computes data flows in Android apps and Java programs. [[link]](https://github.com/secure-software-engineering/FlowDroid)
- **Monkey**: An open source security tool for testing a data center's resiliency to perimeter breaches and internal server infection. The Monkey uses various methods to self propagate across a data center and reports success to a centralized Monkey Island server. [[link]](https://github.com/guardicore/monkey)
- **DroidBox**: Dynamic analysis of Android apps [[link]](https://github.com/pjlantz/droidbox)
- **DroidBot**: A lightweight test input generator for Android. Similar to Monkey, but with more intelligence and cool features. [[link]](https://github.com/honeynet/droidbot)
- **Soot**: Soot - A framework for analyzing and transforming Java and Android applications [[link]]([Soot | Soot - A framework for analyzing and transforming Java and Android applications (soot-oss.github.io)](http://soot-oss.github.io/soot/))



<h2 id="5"> Supplementary materials </h2>

### Deep learning 
Research Papers
- Deep learning - LeCun, Yann, Yoshua Bengio, and Geoffrey Hinton. Nature, 2015, [[pdf]](https://www.nature.com/articles/nature14539)
- Deep learning - Goodfellow, Ian, et al. MIT press, 2016, [[pdf1]](https://synapse.koreamed.org/upload/SynapseData/PDFData/1088HIR/hir-22-351.pdf)[[pdf2]](http://www.academia.edu/download/53631590/Deep_Learning_Bengio_2015-10-03.pdf)
- Deep learning in neural networks: An overview - Schmidhuber, Jürgen. Neural networks, 2015, [[pdf]](https://www.sciencedirect.com/science/article/pii/S0893608014002135)

Online Tutorials and Repositories
-  Awesome - Most Cited Deep Learning Papers - [[Project link]](https://github.com/terryum/awesome-deep-learning-papers#natural-language-processing--rnns)
-  Deep Learning Papers Reading Roadmap - [[Project link]](https://github.com/floodsung/Deep-Learning-Papers-Reading-Roadmap)
-  Top Deep Learning Projects -[[Project link]](https://github.com/aymericdamien/TopDeepLearning)
-  Tracking Progress in Natural Language Processing -[[Project link]](https://github.com/sebastianruder/NLP-progress)
-  Deep Learning Tutorial - by Haozan Liang, only Chinese version, continously maintaining and updating, [[Project link]](https://github.com/Mikoto10032/DeepLearning)

Tools: [Tensorflow](https://github.com/tensorflow/tensorflow), [keras](https://github.com/keras-team/keras), [scikit-learn](https://github.com/scikit-learn/scikit-learn), [pytorch](https://github.com/pytorch/pytorch)

### Android Malware Analysis
Research Papers
- Android security: a survey of issues, malware penetration, and defenses - Faruki P, Bharmal A, Laxmi V, et al. IEEE communications surveys & tutorials, 2014, [[pdf]](https://ieeexplore.ieee.org/abstract/document/6999911/) 
- A taxonomy and qualitative comparison of program analysis techniques for security assessment of android software - Sadeghi A, Bagheri H, Garcia J, et al. IEEE Transactions on Software Engineering, 2016,  [[pdf]](https://ieeexplore.ieee.org/abstract/document/7583740/)
- The Evolution of Android Malware and Android Analysis Techniques - Tam K, Feizollah A, Anuar N B, et al. ACM Computing Surveys (CSUR), 2017, [[pdf]](https://dl.acm.org/doi/abs/10.1145/3017427)
- Static analysis of android apps: A systematic literature review - Li L, Bissyandé T F, Papadakis M, et al. Information and Software Technology, 2017, [[pdf]](http://158.64.76.181/bitstream/10993/31636/1/li2017static.pdf) [[Project link]](http://lilicoding.github.io/SA3Repo/)
- A Survey on Malware Detection Using Data Mining Techniques - Ye Y, Li T, Adjeroh D, et al. ACM Computing Surveys (CSUR), 2017, [[pdf]](https://dl.acm.org/doi/abs/10.1145/3073559)
- A survey on various threats and current state of security in android platform - Bhat P, Dutta K. ACM Computing Surveys (CSUR), 2019, [[pdf]](https://dl.acm.org/doi/abs/10.1145/3301285)
- A survey of Android malware detection with deep neural models - Qiu J, Zhang J, Luo W, et al. ACM Computing Surveys (CSUR), 2020,  [[pdf]](https://dl.acm.org/doi/abs/10.1145/3417978)




<h2 id="5"> Recent Publications </h2>

Recent relevant studies (Last update: 2022-07, we welcome our fellow researchers to update recent works)

### 2021
- [MEGDroid: A model-driven event generation framework for dynamic android malware analysis](https://www.sciencedirect.com/science/article/pii/S0950584921000525); Information and Software Technology, 2021
- [GDroid: Android Malware Detection and Classification with Graph Convolutional Network](https://www.sciencedirect.com/science/article/pii/S0167404821000882?casa_token=HjHFMvPKl3EAAAAA:QvjArLT0vwPFa0x4vV6uIFQESTzTuMA_hr_-TqnTNoywXGDtHWvH8Mvrdr2zIQ5PSIRKi8E2pA); Computers & Security, 2021
- [Op2Vec: An Opcode Embedding Technique and Dataset Design for End-to-End Detection of Android Malware](https://arxiv.org/abs/2104.04798);  arXiv preprint arXiv:2104.04798, 2021
- [Towards an interpretable deep learning model for mobile malware detection and family identification](https://www.sciencedirect.com/science/article/pii/S0167404821000225);  Computers & Security, 2021
- [NATICUSdroid: A malware detection framework for Android using native and custom permissions](https://www.sciencedirect.com/science/article/pii/S2214212620308437);  Journal of Information Security and Applications, 2021
-  [Mimosa: Reducing malware analysis overhead with coverings](https://arxiv.org/abs/2101.07328);  arXiv preprint arXiv:2101.07328, 2021.
-  [IoTMalware: Android IoT Malware Detection based on Deep Neural Network and Blockchain Technology](https://arxiv.org/abs/2102.13376); arXiv preprint, 2021.
-  [Formal Equivalence Checking for Mobile Malware Detection and Family Classification](https://ieeexplore.ieee.org/abstract/document/9381654/);  IEEE Transactions on Software Engineering (2021).
-  [A privacy and security analysis of early-deployed COVID-19 contact tracing Android apps](https://link.springer.com/article/10.1007/s10664-020-09934-4); Empirical Software Engineering, 2021, 26(3): 1-51.
-  [Understanding worldwide private information collection on android](https://arxiv.org/abs/2102.12869); arXiv preprint, 2021.
-  [Systematic Mutation-Based Evaluation of the Soundness of Security-Focused Android Static Analysis Techniques](https://dl.acm.org/doi/abs/10.1145/3439802); ACM Transactions on Privacy and Security (TOPS), 2021
-  [Malware Detection employed by Visualization and Deep Neural Network](https://www.sciencedirect.com/science/article/pii/S0167404821000717); Computers & Security, 2021
-  [Malware Detection and Analysis: Challenges and Research Opportunities](https://arxiv.org/abs/2101.08429); arXiv preprint, 2021.
-  [Towards interpreting ML-based automated malware detection models: a survey](https://arxiv.org/abs/2101.06232); arXiv preprint, 2021.
-  [A Novel Few-Shot Malware Classification Approach for Unknown Family Recognition with Multi-Prototype Modeling](https://www.sciencedirect.com/science/article/pii/S0167404821000973); Computers & Security, 2021
-  [Obfuscation-Resilient Executable Payload Extraction From Packed Malware](https://www.usenix.org/conference/usenixsecurity21/presentation/cheng-binlin);{USENIX} Security, 2021
-  [Marked for Disruption: Tracing the Evolution of Malware Delivery Operations Targeted for Takedown](https://arxiv.org/abs/2104.01631); arXiv preprint, 2021.
-  [Lessons Learnt on Reproducibility in Machine Learning Based Android Malware Detection](https://link.springer.com/article/10.1007/s10664-021-09955-7), in Empirical Software Engineering (EMSE).2021

### 2022
-  [MalWhiteout: Reducing Label Errors in Android Malware Detection](); in 37th IEEE/ACM International Conference on Automated Software Engineering (ASE); 2022; [code](https://github.com/MalTools/MalWhiteout)
-  [Explainable AI for Android Malware Detection: Towards Understanding Why the Models Perform So Well?](https://www.researchgate.net/publication/362885641_Explainable_AI_for_Android_Malware_Detection_Towards_Understanding_Why_the_Models_Perform_So_Well); in International Symposium on Software Reliability Engineering (ISSRE), 2022
-  [TaintBench: Automatic real-world malware benchmarking of Android taint analyses](https://link.springer.com/article/10.1007/s10664-021-10013-5); in Empirical Software Engineering, 2022
-  [A Deep Dive Inside DREBIN: An Explorative Analysis beyond Android Malware Detection Scores](https://dl.acm.org/doi/full/10.1145/3503463); in ACM Transactions on Privacy and Security, 2022
-  [Rotten Apples Spoil the Bunch: An Anatomy of Google Play Malware](https://people.ece.ubc.ca/mjulia/publications/GooglePlayMalware_2022.pdf); in International Conference on Software Engineering (ICSE), 2022, [online](https://resess.github.io/artifacts/GooglePlayMalwareAnalysis/index.html)
- [Debiasing Android Malware Datasets: How Can I Trust Your Results If Your Dataset Is Biased?](https://ieeexplore.ieee.org/document/9787514); in IEEE Transactions on Information Forensics and Security (TIFS), 2022
- [Eight Years of Rider Measurement in the Android Malware Ecosystem](https://ieeexplore.ieee.org/abstract/document/9050439); in IEEE Transactions on Dependable and Secure Computing (TDSC), 2022
- [AndroOBFS: Time-tagged Obfuscated Android Malware Dataset with Family Information](https://ieeexplore.ieee.org/document/9796156); in IEEE/ACM 19th International Conference on Mining Software Repositories (MSR), 2022
- [On the Relativity of Time: Implications and Challenges of Data Drift on Long-Term Effective Android Malware Detection](https://www.sciencedirect.com/science/article/pii/S0167404822002292); in Computers & Security, 2022

